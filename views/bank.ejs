<%- include("header") -%>

    <!-- OG Tags Start -->  
    <meta property="og:title" content="IFSC">
    <meta property="og:url" content="">
    <meta property="og:description" content="">
    <meta property="og:type" content="">
    <meta property="og:image" content="">
    <meta property="og:site_name" content="">
    <meta property="og:street-address" content="">
    <meta property="og:locality" content="">
    <meta property="og:region" content="">
    <meta property="og:country-name" content="India">
    <meta property="og:email" content="">
    <meta property="og:phone_number" content="">
    <title>BAnk Account Verification</title>   
    <link rel="icon" href="./img/favicon.svg" sizes="32x32" type="image/png"> 

    <!-- CSS Stylesheets -->

    <link href="./css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="./css/mystyle.css" rel="stylesheet" type="text/css">
    <!-- FONT -->
    <link href="./fonts/asap/stylesheet.css" rel="stylesheet" type="text/css">	

</head>
<body>


	<div class="wrapper">

		<div class="main">
			<div class="mainmenu" id="mainmenu">
				<div class="menu">
	<ul>
		<li class="d-block d-lg-none"><button class="close" id="closeBtn"></button></li>
		<li class=""><a href="/pan">PAN </a></li>
		<li class=""><a href="/aadhar">Aadhaar</a></li>
        <li class=""><a href="/ifsc">IFSC</a></li>
        <li class="active"><a href="/bank">Bank Account </a></li>
		<li class=""><a href="/cin">CIN</a></li>
        <li class=""><a href="/din">DIN</a></li>
        <li class=""><a href="#">Income Tax-ITR</a></li>
        <li class=""><a href="#">Income Form 16</a></li>
        <li class=""><a href="#">GSTIN</a></li>
        <li class=""><a href="#">Aadhaar Signature</a></li>
        <li class=""><a href="#">Video KYC</a></li>
        <li class=""><a href="#">Passport </a></li>
        <li class=""><a href="#">CIBIL</a></li>
	</ul>
	</div><!-- menu -->			</div>
				<div class="d-lg-none">
				<button class="menuBtn"><img src="./img/menu.svg" alt></button>
		</div>
<!--end of Navigation bar-->

			<div class="content">
				<div class="contbox">
					<div class="row">
					
					<div class="col">
					<div class="formicon">
						<img src="./img/bank.svg" alt>
					</div><!-- formicon -->
					<h1>BAnk Account Verification</h1>
					</div><!-- col -->

					<form class="needs-validation"  method="GET" action="\bank" novalidate>
                             <!-- class="was-validated" needs-validation -->
					    <div class="col mb-3">
					      <label for="validationCustom01">IFSC  </label>
					      <input type="text" class="form-control" pattern="[a-zA-Z]{4}[0]{1}[0-9]{6}" name="pan" id="validationCustom01" required>
					      <div class="valid-feedback ">
					        Looks Good!
					      </div>
					      <div class="invalid-feedback ">
					        Please Enter IFSC Number.
					      </div>
					    </div>
						<div class="col mb-3">
							<label for="validationCustom02">Account Number  </label>
							<input type="text" class="form-control" name="account_num" id="validationCustom02" required>
							<div class="valid-feedback ">
							  Looks Good!
							</div>
							<div class="invalid-feedback ">
							  Please Enter Account Number.
							</div>
						  </div>

					    <div class="col">
					  		<button id="verify" class="btn btn-submit" type="button" >Verify</button>
					  	</div>

					</form>

					</div><!-- row -->
				
					<div class="row" id="dataList">
						<div class="maindata">
							<table class="table table-hover">
							<tr>
								<td>Acc Number </td>
								<td>:</td>
								<td  id="accountnum"></td>
                                <td id="flag"><i id="faflag" aria-hidden="true"></i></td>								

							</tr>
							<tr>
								<th>Name</th>
								<th>:</th>
								<th  id="accHolderName"></th>
							</tr>
							<tr>
								<td>Reference Id</td>
								<td>:</td>
								<td  id="referenceId"></td>
							</tr>
                            <tr>
								<td>Message</td>
								<td>:</td>
								<td  id="message"></td>
							</tr>
							</table>
						</div><!-- maindata -->
					</div><!-- row -->

				</div><!-- contbox -->
			</div><!-- cointent -->
		</div><!-- main -->
	</div><!-- wrapper -->


    <script src="./js/jquery-3.5.1.min.js"></script> 
    <script src="./js/bootstrap.bundle.min.js"></script>
    <script src="./js/main.js"></script>
<script>
// Example starter JavaScript for disabling form submissions if there are invalid fields
(function() {
  'use strict';
  window.addEventListener('load', function() {
	$('#dataList').hide(); 
    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    var forms = document.getElementsByClassName('needs-validation');
    // Loop over them and prevent submission
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('click', function(event) {
        if (!(form.checkValidity())) {
          event.preventDefault();
          event.stopPropagation();
		  $('#dataList').hide(); 
        }
        form.classList.add('was-validated');		
      }, false);
    });
  }, false);
})();
</script>
<script>
  $('#validationCustom01').keypress(function (e) {
 var key = e.which;
 if(key == 13)  // the enter key code
  {
    $('#verify').click();
    return false;  
  }
}); 
</script>

<script>
	$('#validationCustom02').keypress(function (e) {
   var key = e.which;
   if(key == 13)  // the enter key code
	{
	  $('#verify').click();
	  return false;  
	}
  }); 
  </script>

<script>
$(document).ready(function(){	
	
		$('#verify').on('click', function(){
			$('#dataList').hide(); 
			var ifsc = $('#validationCustom01').val();
			var accountnum = $('#validationCustom02').val();
			// var name = $('#validationCustom03').val();
			// var mobile = $('#validationCustom04').val();
			var name = "NOT REQUIRED";
			var mobile = "0000000000";
			name = name.split(" ").join("%20");
		
		  $('#accountnum').text(accountnum);
		  $('#accHolderName').text("Loading..");
          $('#referenceId').text("Loading..");
          $('#message').text("Loading..");
					
		  const CODE_PATTERN_IFSC = /^([a-zA-Z]{4}[0]{1}[0-9]{6})$/;
		  
		  console.log(name);
			if ((CODE_PATTERN_IFSC.test(ifsc)))
			{			
			var settings = {
				"url": `https://api.sandbox.co.in/bank/${ifsc}/accounts/${accountnum}/verify?name=${name}&mobile=${mobile}`,
				"method": "GET",		
                 "headers": {
            "Authorization":
           "eyJhbGciOiJIUzUxMiJ9.eyJhdWQiOiJBUEkiLCJyZWZyZXNoX3Rva2VuIjoiZXlKaGJHY2lPaUpJVXpVeE1pSjkuZXlKaGRXUWlPaUpCVUVraUxDSnpkV0lpT2lKMmFXcHBkR2hBYzNKMmFXNW1iM1JsWTJndWFXNGlMQ0poY0dsZmEyVjVJam9pYTJWNVgyeHBkbVZmYTJOYVFtTTJZVUZKU1ZOSGFscFpObXBuWWxoMVRuWnJhMnQ2ZVhkbWJsb2lMQ0pwYzNNaU9pSmhjR2t1YzJGdVpHSnZlQzVqYnk1cGJpSXNJbVY0Y0NJNk1UWTFOelk1TXpFNE9Td2lhVzUwWlc1MElqb2lVa1ZHVWtWVFNGOVVUMHRGVGlJc0ltbGhkQ0k2TVRZeU5qRTFOekU0T1gwLlc2NzB2LWhHRGV4Mmp1aURCdGtLbkd0Wk1MZW5YYWFtWnlfbl9LTmxod3l2S0dVMmtQMVlRTWlYS1JWaHdncVdicGJDeVczUm1TUmFfYmxwazZQMnl3Iiwic3ViIjoidmlqaXRoQHNydmluZm90ZWNoLmluIiwiYXBpX2tleSI6ImtleV9saXZlX2tjWkJjNmFBSUlTR2paWTZqZ2JYdU52a2trenl3Zm5aIiwiaXNzIjoiYXBpLnNhbmRib3guY28uaW4iLCJleHAiOjE2MjYyNDM1ODksImludGVudCI6IkFDQ0VTU19UT0tFTiIsImlhdCI6MTYyNjE1NzE4OX0.vhyX2rgIxyMYVPVa8I92q4JxhrSByVvVrO_QfrQ9N08e7PA7A8ZBnnGt0bmNzjElmOEjuI_mOi43mpzgmqckCQ",
           "x-api-key": "key_live_kcZBc6aAIISGjZY6jgbXuNvkkkzywfnZ",
           "x-api-version": "3.4.0",
  },
  maxRedirects: 20,
//   path: "/bank/ICIC0000040/accounts/004001523189/verify?name=SANDEEP%20NARAYAN%20K%20V&mobile=9986714400",
        
};
console.log(settings);

$.ajax(settings).always(function (response) {
  console.log(response);
        let accountnum;
        let name_at_bank;
		let  referenceId;
        let message;
        if (response.data.account_exists)
        {
            //  accountnum = response.data.name_at_bank;
             name_at_bank = response.data.name_at_bank;
             referenceId = response.data.reference_id;
             message = "Account Verified Successfully";
					
		  $('#accountnum').text(accountnum);
		  $('#accHolderName').text(name_at_bank);
          $('#referenceId').text(referenceId);
          $('#message').text(message);
          $('#faflag').removeClass("fa fa-window-close");
		  $('#faflag').addClass("fa fa-check");
        }
        else{
          
		  $('#accountnum').text(accountnum);
		  $('#accHolderName').text('Invalid Account #/IFSC');
          $('#referenceId').text('Invalid Account #/IFSC');
          $('#message').text('Invalid Account #/IFSC');          
		  $('#faflag').removeClass("fa fa-check");
          $('#faflag').addClass("fa fa-window-close");
        }
          	 
 });			
			}
			else
			{
			
		  $('#accountnum').text(accountnum);
		  $('#accHolderName').text('Invalid Account #/IFSC');
          $('#referenceId').text('Invalid Account #/IFSC');
          $('#message').text('Invalid Account #/IFSC'); 
          $('#faflag').removeClass("fa fa-check");
          $('#faflag').addClass("fa fa-window-close");
			}
			$('#dataList').show();
	});
	});
</script>
</body>
</html>